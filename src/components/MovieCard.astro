---
import { Image } from "astro:assets";
import { Card } from "@/components/ui/card";
import { resolveImageUrl, imagePresets } from "@/lib/wsrv";
interface Props {
    index: number;
    slug: string;
    name: string;
    year: string;
    image: string;
}

const { index, slug, name, image, year } = Astro.props;

const imageSource = resolveImageUrl(image);
const thumbnailPreset = imagePresets.thumbnail;
---

<a href={`/phim/${slug}`} class="group block" data-astro-prefetch="hover">
    <Card
        className="overflow-hidden border border-transparent bg-slate-900/60 transition-all duration-300 ease-in-out group-hover:ring-4 group-hover:ring-slate-700/50 shadow-lg hover:shadow-2xl"
    >
        <div class="relative aspect-[2/3]">
            {
                imageSource ? (
                    <Image
                        src={imageSource}
                        alt={name}
                        width={thumbnailPreset.dimension.width}
                        height={thumbnailPreset.dimension.height}
                        widths={thumbnailPreset.widths}
                        sizes={thumbnailPreset.sizes}
                        quality={thumbnailPreset.quality}
                        fit="cover"
                        loading={index === 0 ? "eager" : "lazy"}
                        transition:name={`image-${slug}`}
                        class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105"
                    />
                ) : (
                    <div class="flex h-full w-full items-center justify-center bg-slate-800 text-xs text-white/60">
                        No Image
                    </div>
                )
            }
        </div>
        <div class="space-y-1 px-4 py-3">
            <h2
                class="text-base font-semibold text-white line-clamp-1 transition-colors duration-200 group-hover:text-sky-300"
                transition:name={`title-${slug}`}
            >
                {name}
            </h2>
            <p
                class="text-sm text-slate-300 transition-colors duration-200 group-hover:text-slate-200"
            >
                {year}
            </p>
        </div>
    </Card>
</a>
